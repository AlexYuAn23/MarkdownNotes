# 操作系统常见面试题



## 进程和线程的区别

**进程** 是系统进行 **资源分配** 和 **调度** 的一个独立单位，**最小的资源管理单位**。

**线程** 是进程的一个实体，是 **CPU 调度和分派的基本单位**，它是比进程更小的能独立运行的基本单位，**最小的 CPU 执行单元**。

线程拥有的资源：程序计数器、寄存器、栈、状态字。

**进程和线程的主要差别在于它们是不同的操作系统资源管理方式。**

进程有独立的地址空间，一个进程崩溃后，在保护模式下不会对其它进程产生影响。线程只是一个进程中的不同执行路径。线程有自己的堆栈和局部变量，但线程之间没有单独的地址空间，一个线程死掉就等于整个进程死掉，所以多进程的程序要比多线程的程序健壮，但在进程切换时，耗费资源较大，效率要差一些。但对于一些要求同时进行并且又要共享某些变量的并发操作，只能用线程，不能用进程。

- 简而言之，一个程序至少有一个进程，一个进程至少有一个线程。
- 线程的划分尺度小于进程，使得多线程程序的并发性高。
- 进程在执行过程中拥有独立的内存单元，而多个线程共享内存，从而极大地提高了程序的运行效率。
- 多线程的意义在于一个应用程序中，有多个执行部分可以同时执行。但操作系统并没有将多个线程看做多个独立的应用，来实现进程的调度和管理以及资源分配。这就是进程和线程的重要区别。



## 进程通信方式

- **管道：** 半双工通信方式，数据只能在父子进程间单向流动。
- **有名管道：** 半双工通信方式，数据能在非父子进程间单向流动。
- **信号量：** 信号量实际上是一个计数器，可以用来控制多个进程对共享资源的访问，**可以被用来作为一种锁机制，即可作为不同进程间或者同一进程的不同线程间的同步手段。**
- **消息队列：** 是由消息组成的链表。克服了信号量传递信息少，管道只能承载无格式字节流以及缓冲区大小受限等缺点。
- **信号：** 用于通知进程某个事件已经发生。
- **共享内存：** 映射一段能被其他进程访问的内存，即共享内存由一个进程创建，但是多个进程都可以访问，可以和信号量配合使用。
- **Socket：** 与其他通信机制不同的是，Socket 可用于不同主机间的进程通信。



## 信号量

### PV 原语

PV 操作由 P 操作原语和 V 操作原语组成（原语是不可中断的过程），可以对信号量进行操作。

- `P(s)`：将 S 减 1，如果 S < 0，进程会进入等待状态，进入等待队列。(加锁操作)
- `V(S)`：将 S 加 1，如果 S < 0，会释放等待队列中的第一个等待信号量的进程。(放锁操作)

### 什么是信号量

信号量的数据结构为一个值和一个指针，指针指向等待该信号量的下一个进程。

信号量的值与相应资源的使用情况有关。

- 当它的值大于 0 时，表示当前可用资源的数量；
- 当它的值小于 0 时，其绝对值表示等待使用该资源的进程个数。

信号量的值仅能由 PV 操作来改变。

### 信号量和互斥锁的区别

信号量不一定是锁定某一个资源，而是流程上的概念，比如：有 A，B 两个线程，B 线程要等 A 线程完成某一任务以后再进行自己下面的步骤，这个任务并不一定是锁定某一资源，还可以是进行一些计算或者数据处理之类。而线程互斥量则是 “锁住某一资源” 的概念，在锁定期间内，其他线程无法对被保护的数据进行操作。在有些情况下两者可以互换。 



## 僵尸进程

当子进程比父进程先结束，而父进程又没有回收子进程，释放子进程占用的资源，此时子进程将成为一个僵尸进程。

**怎样来清除僵尸进程：**

- 把父进程杀掉。父进程死后，僵尸进程成为”孤儿进程”，过继给 1 号进程 init，init 始终会负责清理僵尸进程。它产生的所有僵尸进程也跟着消失。
- 改写父进程，在子进程死后要为它收尸。。子进程死后，会发送 SIGCHLD 信号给父进程，父进程收到此信号后，执行 waitpid() 函数为子进程收尸。



## 死锁



